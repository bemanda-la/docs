# Actualización de usuario como administrador

Esta guía detalla cómo actualizar la información de un usuario en el sistema utilizando su ID, basada en el modelo definido.

## Endpoint

`PATCH /v1/user/:user_id`

## Autenticación

Este endpoint requiere autenticación mediante un token Bearer. Incluye el encabezado `Authorization` en tu solicitud:

```
Authorization: Bearer <tu_token>
```

Asegúrate de reemplazar `<tu_token>` con un token válido. Para obtener un token, consulta la guía de [autenticación](/docs/authentication/).

## Parámetros

- `user_id` (path): Identificador único del usuario en formato UUID.

## Cuerpo de la Solicitud (Body)

El cuerpo de la solicitud debe ser un objeto JSON con los siguientes campos:

```json
{
  "first_name": "string",
  "last_name": "string",
  "birthdate": "string",
  "gender": "string",
  "civil_status": "string"
  "photo_uri": "string"
}
```

### Detalles de los Campos

- **first_name (opcional):** Nombre del usuario.
- **last_name (opcional):** Apellido del usuario.
- **birthdate (opcional):** Fecha de nacimiento del usuario en formato `YYYY-MM-DD` .
- **gender (opcional):** Género del usuario. Valores permitidos: MALE, FEMALE, OTHER.
- **civil_status (opcional):** Estado civil del usuario. Valores permitidos: SINGLE, MARRIED, DIVORCED, WIDOWED.
- **photo_uri (opcional):** URL de la foto del usuario, debe ser una URL válida.

## Ejemplos de Llamadas

### Usando cURL

```bash
curl -X PATCH \
  {base_url}/v1/user/:user_id \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "first_name": "Juan",
    "last_name": "Pérez",
    "birthdate": "1985-06-15",
    "gender": "MALE",
    "civil_status": "SINGLE",
    "photo_uri": "https://example.com/photo.jpg"
  }'
```

### Usando Node.js

```javascript
const fetch = require("node-fetch");

async function updateUser(user_id, token, updateData) {
  const response = await fetch(`${base_url}/v1/user/${user_id}`, {
    method: "PATCH",
    headers: {
      Authorization: `Bearer ${token}`,
      "Content-Type": "application/json",
    },
    body: JSON.stringify(updateData),
  });

  if (!response.ok) {
    throw new Error(`Error updating user: ${response.statusText}`);
  }

  const responseData = await response.json();
  console.log(responseData);
}

// Ejemplo de uso
const user_id = "YOUR_USER_ID";
const token = "YOUR_ACCESS_TOKEN";
const updateData = {
  first_name: "Juan",
  last_name: "Pérez",
  birthdate: "1985-06-15",
  gender: "MALE",
  civil_status: "SINGLE",
  photo_uri: "https://example.com/photo.jpg",
};

updateUser(user_id, token, updateData).catch(console.error);
```

## Respuesta

La respuesta incluye la estructura estándar para los recursos, con los siguientes elementos:

### Estructura de Respuesta

```json
{
  "success": true,
  "data": {
    "message": "User information updated successfully.",
    "updated_fields": {
      "first_name": "Juan",
      "last_name": "Pérez",
      "birthdate": "1985-06-15T00:00:00.000Z",
      "gender": "MALE",
      "civil_status": "SINGLE",
      "photo_uri": "https://example.com/photo.jpg"
    }
  },
  "error": null,
  "pagination": null
}
```

### Detalles de los Campos

- **success:** Indica si la solicitud fue exitosa (`true` o `false`).
- **data:** Objeto con la información de los campos actualizados.
  - **message:** Mensaje de confirmación.
  - **updated_fields:** Contiene los campos modificados y sus nuevos valores
- **error:** Contendrá detalles de errores en caso de que existan, incluyendo:
  - **code:** Código del error.
  - **message:** Mensaje general del error.
  - **errors:** Lista de errores específicos, cada uno con:
    - **message:** Descripción del error.
    - **location:** Ubicación del error.
- **pagination:** Información de paginación, será `null` porque este recurso no es una lista.

## Notas

- Todos los campos en el cuerpo de la petición son opcionales. Solo se actualizarán los valores proporcionados.
- Asegúrate de que el `user_id` corresponde a un usuario existente antes de realizar la consulta.
- Para validar la autenticidad de las solicitudes, utiliza las firmas digitales incluidas en los encabezados del webhook.
- Si un valor no cumple con las validaciones establecidas, la solicitud fallará con un error `400 Bad Request`.
- La fecha de nacimiento (`birthdate`) debe estar en formato `YYYY-MM-DD`. Si es válida, se convertirá a formato ISO (`YYYY-MM-DDTHH:MM:SS.sssZ`).
- `photo_uri` debe ser una URL válida.
