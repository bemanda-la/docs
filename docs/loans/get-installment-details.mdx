# Consulta de Cuotas por Préstamo

Este endpoint permite obtener la lista de cuotas asociadas a un préstamo específico. La información incluye detalles sobre cada cuota, como fechas de vencimiento, montos a pagar, montos pagados, saldo, y el estado de cada cuota.

## Endpoint

`GET /v1/apps/loans/installment/:loan_id`

## Requisitos de Acceso

- **Scope necesario:** `admin`
- **Autenticación:** Se requiere un token Bearer válido.

Incluye el encabezado `Authorization` en tu solicitud:

```http
Authorization: Bearer <tu_token>
```

Asegúrate de reemplazar `<tu_token>` con un token válido. Para obtener un token, consulta la guía de [autenticación](/docs/authentication/).

## Parámetros

### URL Parameters

- **loan_id:** El identificador único del préstamo del cual se obtendrán las cuotas

### Query Parameters

- **page** (opcional): Número de página a consultar (por defecto `1`).
- **items_per_page** (opcional): Cantidad de elementos por página (por defecto `10`).

## Ejemplos de Llamadas

### Usando cURL

```bash
curl -X GET \
  {base_url}/v1/apps/loans/installment/{loan_id}?page=1&items_per_page=10 \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -H "Content-Type: application/json"
```

### Usando Node.js

```javascript
import fetch from "node-fetch";

async function getInstallmentsByLoanId(
  token,
  loan_id,
  page = 1,
  itemsPerPage = 10
) {
  const response = await fetch(
    `${base_url}/v1/apps/loans/installment/${loan_id}?page=${page}&items_per_page=${itemsPerPage}`,
    {
      method: "GET",
      headers: {
        Authorization: `Bearer ${token}`,
        "Content-Type": "application/json",
      },
    }
  );

  if (!response.ok) {
    throw new Error(`Error fetching installments: ${response.statusText}`);
  }

  const data = await response.json();
  console.log(data);
}

// Ejemplo de uso
const token = "YOUR_ACCESS_TOKEN";
const loan_id = "018c0f5b-4d4b-7bde-89a6-6f2a4d60f56e";
getInstallmentsByLoanId(token, loan_id).catch(console.error);
```

## Respuesta

La respuesta incluye una lista de cuotas asociadas al préstamo especificado y su paginación.

### Estructura de Respuesta

```json
{
  "success": true,
  "data": [
    {
      "id": "1a8c0f5b-4d4b-7bde-89a6-6f2a4d60f56e",
      "loan_id": "018c0f5b-4d4b-7bde-89a6-6f2a4d60f56e",
      "due_date": "2025-02-01T00:00:00Z",
      "currency_id": "ARS",
      "due_amount": 5000.0,
      "paid_amount": 2500.0,
      "balance": 2500.0,
      "number": 1,
      "status_id": "pending",
      "created_at": "2025-01-01T12:00:00Z",
      "updated_at": "2025-01-15T12:00:00Z"
    },
    {
      "id": "2a8c0f5b-4d4b-7bde-89a6-6f2a4d60f56e",
      "loan_id": "018c0f5b-4d4b-7bde-89a6-6f2a4d60f56e",
      "due_date": "2025-03-01T00:00:00Z",
      "currency_id": "ARS",
      "due_amount": 5000.0,
      "paid_amount": 0.0,
      "balance": 5000.0,
      "number": 2,
      "status_id": "pending",
      "created_at": "2025-01-01T12:00:00Z",
      "updated_at": "2025-01-15T12:00:00Z"
    }
  ],
  "error": null,
  "pagination": {
    "page": 1,
    "items_per_page": 10,
    "total_items": 20,
    "total_pages": 2
  }
}
```

### Detalles de los Campos

### Campos Principales

- **success:** Indica si la solicitud fue exitosa.
- **data:** Lista de préstamos del usuario autenticado.
- **error:** Detalles del error (si existe).
- **pagination:** Información de paginación.

### Campos de una Cuota

- **id:** Identificador único de la cuota.
- **loan_id:** Identificador del préstamo asociado.
- **due_date:** Fecha de vencimiento de la cuota.
- **currency_id:** Moneda de la cuota (generalmente "ARS").
- **due_amount:** Monto a pagar en la cuota.
- **paid_amount:** Monto ya pagado de la cuota.
- **balance:** Monto restante por pagar de la cuota.
- **number:** Número de la cuota (1, 2, 3, etc.).
- **status_id:** Estado de la cuota (por ejemplo, "pending", "paid").
- **created_at:** Fecha de creación de la cuota.
- **updated_at:** Fecha de la última actualización de la cuota.

## Notas

- Este endpoint es paginado. Utiliza los parámetros page y items_per_page para controlar la cantidad de resultados devueltos. Si no se especifican, se utilizarán los valores por defecto (page=1 y items_per_page=10).
- Requiere permisos específicos (`scope: admin`).
- El campo status_id indica el estado de la cuota. Asegúrate de manejar correctamente los diferentes estados (por ejemplo, "pending" para cuotas no pagadas).
- El formato de las fechas (due_date, created_at, updated_at) es en el formato ISO 8601. Asegúrate de manejar correctamente las fechas y horas en tu aplicación.
